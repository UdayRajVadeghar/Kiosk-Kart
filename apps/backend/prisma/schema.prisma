generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model cart_products {
  cart_id    String @db.Uuid
  product_id String @db.Uuid
  quantity   Int

  @@id([cart_id, product_id])
}

model carts {
  id         String   @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  user_id    String?  @unique @db.Uuid
  created_at DateTime @default(now()) @db.Timestamp(6)
  users      users?   @relation(fields: [user_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
}

model categories {
  id                 String               @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  name               String               @unique @db.VarChar(100)
  created_at         DateTime?            @default(now()) @db.Timestamp(6)
  product_categories product_categories[]
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model order_products {
  order_id   String  @db.Uuid
  product_id String  @db.Uuid
  quantity   Int
  price      Decimal @db.Decimal(10, 2)
  orders     orders  @relation(fields: [order_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@id([order_id, product_id])
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model orders {
  id             String           @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  user_id        String?          @db.Uuid
  status         String?          @default("pending") @db.VarChar(20)
  total          Decimal?         @db.Decimal(10, 2)
  created_at     DateTime?        @default(now()) @db.Timestamp(6)
  order_products order_products[]
  payments       payments?

  @@index([user_id], map: "idx_orders_user_id")
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model payments {
  id             String    @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  order_id       String?   @unique @db.Uuid
  payment_method String?   @db.VarChar(20)
  status         String?   @default("pending") @db.VarChar(20)
  created_at     DateTime? @default(now()) @db.Timestamp(6)
  orders         orders?   @relation(fields: [order_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
}

model product_categories {
  product_id  String     @db.Uuid
  category_id String     @db.Uuid
  categories  categories @relation(fields: [category_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@id([product_id, category_id])
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model products {
  id          String    @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  name        String    @db.VarChar(255)
  description String?
  price       Decimal   @db.Decimal(10, 2)
  stock       Int
  image_url   String?
  seller_id   String    @db.Uuid
  created_at  DateTime? @default(now()) @db.Timestamp(6)
  seller_name String    @db.VarChar(100)

  @@index([name], map: "idx_products_name")
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model reviews {
  id         String    @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  user_id    String?   @db.Uuid
  product_id String?   @db.Uuid
  rating     Int?
  comment    String?
  created_at DateTime? @default(now()) @db.Timestamp(6)
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model users {
  id            String    @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  name          String    @db.VarChar(100)
  email         String    @unique @db.VarChar(100)
  password_hash String
  role          String?   @default("customer") @db.VarChar(20)
  created_at    DateTime? @default(now()) @db.Timestamp(6)
  carts         carts?
}
